var ComExcelImportExport=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t,n,r,o,a,i){try{var l=e[a](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}function n(e){return function(){var n=this,r=arguments;return new Promise((function(o,a){var i=e.apply(n,r);function l(e){t(i,o,a,l,s,"next",e)}function s(e){t(i,o,a,l,s,"throw",e)}l(void 0)}))}}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw o}}return a}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=require("xlsx");function s(){}function c(t){if([null,void 0,NaN,!1].includes(t))return t;if("object"!==e(t)&&"function"!=typeof t)return t;var n,r=(n=t,"[object Array]"===Object.prototype.toString.call(n)?[]:{});for(var o in t)t.hasOwnProperty(o)&&(r[o]="object"===e(t[o])?c(t[o]):t[o]);return r}Date.prototype.Format=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"yyyy-MM-dd HH:mm",t={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e};var u={name:"ComExcelImportExportSample",data:function(){return{multiple:!1}},mounted:function(){},methods:{buildHeader:function(e){var t=this,n=[];this.getHeader(e,n,0,0);var r=Math.max.apply(Math,o(n.map((function(e){return e.length}))));return n.filter((function(e){return e.length<r})).forEach((function(e){return t.pushRowSpanPlaceHolder(e,r-e.length)})),n},getHeader:function(e,t,n,r){var o=0,a=t[n];a||(a=t[n]=[]),this.pushRowSpanPlaceHolder(a,r-a.length);for(var i=0;i<e.length;i++){var l=e[i];if(a.push("".concat(l.label)),l.hasOwnProperty("children")&&Array.isArray(l.children)&&l.children.length>0){var s=this.getHeader(l.children,t,n+1,a.length-1);this.pushColSpanPlaceHolder(a,s-1),o+=s}else o++}return o},extractData:function(e,t){var n=this,r=this.flat(e),a=[],i=new Set(Object.keys(t[0]));return t.some((function(e){if(e.children&&e.children.length>0){for(var t=Object.keys(e.children[0]),n=0;n<t.length;n++)i.delete(t[n]);return!0}})),this.flatData(t,(function(e){a.push.apply(a,o(n.buildExcelRow(i,r,e)))})),a},buildExcelRow:function(e,t,n){for(var r=[],a=[],i=0;i<n.length;i++){for(var l=[],s=n[i],c=0;c<t.length;c++){var u=t[c];if(0===s.rowSpan&&e.has(u.prop))l.push("!$ROW_SPAN_PLACEHOLDER");else{var p=void 0;p="function"==typeof u.exeFun?u.exeFun(s):s[u.prop],l.push(p),u.summable&&"number"==typeof p&&(r[c]=(r[c]?r[c]:0)+p)}}a.push(l)}return r.length>0&&a.push.apply(a,o(this.sumRowHandle(r))),a},sumRowHandle:function(e){return[]},doMerges:function(e){for(var t=e.length,n=[],r=0;r<t;r++)for(var o=e[r],a=0,i=0;i<o.length;i++)"!$COL_SPAN_PLACEHOLDER"===o[i]?(o[i]=void 0,i+1===o.length&&n.push({s:{r:r,c:i-a-1},e:{r:r,c:i}}),a++):a>0&&i>a?(n.push({s:{r:r,c:i-a-1},e:{r:r,c:i-1}}),a=0):a=0;for(var l=e[0].length,s=0;s<l;s++)for(var c=0,u=0;u<t;u++)"!$ROW_SPAN_PLACEHOLDER"===e[u][s]?(e[u][s]=void 0,u+1===t&&n.push({s:{r:u-c,c:s},e:{r:u,c:s}}),c++):c>0&&u>c?(n.push({s:{r:u-c-1,c:s},e:{r:u-1,c:s}}),c=0):c=0;return n},aoa_to_sheet:function(e,t){for(var n={},r={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!==e.length;++o)for(var a=0;a!==e[o].length;++a){r.s.r>o&&(r.s.r=o),r.s.c>a&&(r.s.c=a),r.e.r<o&&(r.e.r=o),r.e.c<a&&(r.e.c=a);var i={v:[void 0,null,""].includes(e[o][a])?"":e[o][a],s:{font:{name:"宋体",sz:11,color:{auto:1}},alignment:{wrapText:1,horizontal:"center",vertical:"center",indent:0}}};o<t&&(i.s.border={top:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}},i.s.fill={patternType:"solid",fgColor:{rgb:"d6eacd"},bgColor:{rgb:"d6eacd"}});var s=l.utils.encode_cell({c:a,r:o});i.t="s",n[s]=i}return r.s.c<1e7&&(n["!ref"]=l.utils.encode_range(r)),n},pushRowSpanPlaceHolder:function(e,t){for(var n=0;n<t;n++)e.push("!$ROW_SPAN_PLACEHOLDER")},pushColSpanPlaceHolder:function(e,t){for(var n=0;n<t;n++)e.push("!$COL_SPAN_PLACEHOLDER")},flatData:function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r],a=[];if(o.children&&o.children.length>0)for(var i=0;i<o.children.length;i++){var l=Object.assign({},o,o.children[i]);a.push(l),l.rowSpan=i>0?0:o.children.length}else o.rowSpan=1,a.push(o);n.push.apply(n,a),"function"==typeof t&&t(a)}return n},flat:function(e){var t=this,n=[];return(e||[]).forEach((function(e){e.hasOwnProperty("children")&&(e.children||[]).length?n.push.apply(n,o(t.flat(e.children))):e.hasOwnProperty("label")&&n.push(e)})),n},s2ab:function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!==e.length;++r)n[r]=255&e.charCodeAt(r);return t},openDownloadXLSXDialog:function(t,n){"object"==e(t)&&t instanceof Blob&&(t=URL.createObjectURL(t));var r,o=document.createElement("a");o.href=t,o.download=n||"",window.MouseEvent?r=new MouseEvent("click"):(r=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(r)},importToExcel:function(e,t){t&&(this.multiple=!0),this.sendRes=e||s,this.$el.click()},exportExport:function(e,t,r){var a=this;return n(regeneratorRuntime.mark((function n(){var i,s,u,p,d,f,h,m,y,g,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=c(e)||[{}],s="".concat(r||"excel文件","_").concat((new Date).Format("MM月dd日HH时mm分")),u=a.buildHeader(t),p=u.length,d=a.extractData(t,i),u.push.apply(u,o(d).concat([[]])),f=a.doMerges(u),h=a.aoa_to_sheet(u,p),console.log(d,u,f,h),h["!merges"]=f,h["!freeze"]={xSplit:"1",ySplit:""+p,topLeftCell:"B"+(p+1),activePane:"bottomRight",state:"frozen"},h["!cols"]=t.map((function(e){return{wpx:e.width||100}})),Array(2).fill({wpx:180}),(m={SheetNames:[s],Sheets:{}}).Sheets[s]=h,y={bookType:"xlsx",bookSST:!1,type:"binary",cellStyles:!0},g=l.write(m,y),v=new Blob([a.s2ab(g)],{type:"application/octet-stream"}),a.openDownloadXLSXDialog(v,s+".xlsx");case 19:case"end":return n.stop()}}),n)})))()},exportExportSheets:function(){var e=arguments,t=this;return n(regeneratorRuntime.mark((function n(){var r,a,i,s,u,p,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=e.length>0&&void 0!==e[0]?e[0]:[],a=e.length>1?e[1]:void 0,i="".concat(a||"excel文件","_").concat((new Date).Format("MM月dd日HH时mm分")),s={SheetNames:[],Sheets:{}},r.map((function(e,n){var r="Sheet"+(n+1);s.SheetNames.push(e.name||r);var a=c(e.tableList)||[{}],i=t.buildHeader(e.headerOptions),l=i.length,u=t.extractData(e.headerOptions,a);i.push.apply(i,o(u).concat([[]]));var p=t.doMerges(i),d=t.aoa_to_sheet(i,l);d["!merges"]=p,d["!freeze"]={xSplit:"1",ySplit:""+l,topLeftCell:"B"+(l+1),activePane:"bottomRight",state:"frozen"},d["!cols"]=((null==e?void 0:e.headerOptions)||[]).map((function(e){return{wpx:e.width||100}})),s.Sheets[e.name||r]=d,console.log(u,i,p,d)})),u={bookType:"xlsx",bookSST:!1,type:"binary",cellStyles:!0},p=l.write(s,u),d=new Blob([t.s2ab(p)],{type:"application/octet-stream"}),t.openDownloadXLSXDialog(d,i+".xlsx");case 9:case"end":return n.stop()}}),n)})))()},importMainExport:function(e){var t=this;if(e.currentTarget.files.length){var n=null,r=null;e.currentTarget.files;for(var o=e.currentTarget.files.length,a=0;a<o;a++){var i=e.currentTarget.files[a].name,s=i.lastIndexOf("."),c=i.substring(s,i.length);".xlsx"===c.toLowerCase()&&(n=e.currentTarget.files[a]),".zip"===c.toLowerCase()&&(r=e.currentTarget.files[a])}if(n){var u=new FileReader;u.onload=function(e){try{var n=e.target.result;0;for(var o=l.read(n,{type:"binary"}),a=o.Sheets[o.SheetNames[0]],i=l.utils.sheet_to_json(a,{header:1}),s=i.length;0<s;s--)i[s-1].length||i.splice(s-1,1);document.querySelector("#upload-export-file").value=null,t.sendRes({code:200,message:"成功",list:i,files:r})}catch(e){t.sendRes({code:500,message:e})}},u.readAsBinaryString(n)}}}}};function p(e,t,n,r,o,a,i,l,s,c){"boolean"!=typeof i&&(s=l,l=i,i=!1);const u="function"==typeof n?n.options:n;let p;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,o&&(u.functional=!0)),r&&(u._scopeId=r),a?(p=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,s(e)),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=p):t&&(p=i?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,l(e))}),p)if(u.functional){const e=u.render;u.render=function(t,n){return p.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,p):[p]}return n}const d="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function f(e){return(e,t)=>function(e,t){const n=d?t.media||"default":e,r=m[n]||(m[n]={ids:new Set,styles:[]});if(!r.ids.has(e)){r.ids.add(e);let n=t.source;if(t.map&&(n+="\n/*# sourceURL="+t.map.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),r.element||(r.element=document.createElement("style"),r.element.type="text/css",t.media&&r.element.setAttribute("media",t.media),void 0===h&&(h=document.head||document.getElementsByTagName("head")[0]),h.appendChild(r.element)),"styleSheet"in r.element)r.styles.push(n),r.element.styleSheet.cssText=r.styles.filter(Boolean).join("\n");else{const e=r.ids.size-1,t=document.createTextNode(n),o=r.element.childNodes;o[e]&&r.element.removeChild(o[e]),o.length?r.element.insertBefore(t,o[e]):r.element.appendChild(t)}}}(e,t)}let h;const m={};var y=p({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("input",{staticClass:"com-excel-import-export-sample",attrs:{type:"file",multiple:!0,id:"upload-export-file"},on:{change:e.importMainExport}})},staticRenderFns:[]},(function(e){e&&e("data-v-0f570d26_0",{source:"#upload-export-file[data-v-0f570d26]{display:none}",map:void 0,media:void 0})}),u,"data-v-0f570d26",false,undefined,!1,f,void 0,void 0),g=Object.freeze({__proto__:null,ComExcelImportExportSample:y}),v=function(e){Object.entries(g).forEach((function(t){var n=r(t,2),o=n[0],a=n[1];e.component(o,a);var i=new(e.extend(a))({propsData:{}}),l=document.createElement("div");window.document.body.appendChild(l),i.$mount(l),window.setTimeout((function(e){}),4e3),e.prototype.$excelFile=i,e.prototype.$excelOpen=i.importToExcel,e.prototype.$excelToFile=i.exportExport,e.prototype.$exportExportSheets=i.exportExportSheets}))},b=Object.freeze({__proto__:null,default:v,ComExcelImportExportSample:y});return Object.entries(b).forEach((function(e){var t=r(e,2),n=t[0],o=t[1];"default"!==n&&(v[n]=o)})),v}();